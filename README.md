# 🛻 Online Car Appointment Subroutine

一个基于 **UniApp + Vue.js + Unicloud** 开发的网约车小程序，支持用户打车与司机接单功能，结合腾讯地图 API 和云函数实现完整的前后端功能闭环。

## 🚀 技术栈

- **前端框架**：Vue.js（UniApp）
- **后端服务**：Unicloud 云开发
- **数据库**：MongoDB（JQL 简洁语法）
- **地图服务**：腾讯地图 API
- **数据处理**：Unicloud 云函数

---

## 📱 核心功能

### 一、用户端功能

#### 1. 登录系统
- 接入微信小程序官方 API，获取用户 `openid`
- 区分 **用户端** 和 **司机端** 登录界面
- 新用户首次登录时自动注册并上传数据至数据库

#### 2. 打车流程
- 集成腾讯地图 API，展示地图并允许用户选择起点与终点
- 创建打车订单并保存至 MongoDB 数据库
- 云函数判断接单情况并进行动态处理

---

### 二、司机端功能

#### 1. 登录系统
- 单独的司机身份验证与注册机制
- 可切换三种工作模式：

##### 🚦 模式切换说明
| 模式 | 功能说明 |
|------|----------|
| 下线模式 | 查看订单，不可接单 |
| 抢单模式 | 实时查看并手动抢单 |
| 派单模式 | 系统自动派单，5km内最近司机优先，拒单后扣分，订单转入大厅 |

> 注：派单模式下通过云函数调用腾讯地图的“驾车路线矩阵”接口获取最近司机信息。

#### 2. 接单与服务流程
- 接单后自动规划路线前往乘客位置
- 乘客通过手机号验证进行上车确认
- 抵达目的地（<10m）后订单自动完成并记录

---

## ☁️ 部署与上线

### 一、小程序平台配置
- 微信开放平台配置接口权限
- 管理版本发布及开发设置

### 二、服务端部署
- 使用 Unicloud 提供的云数据库和云函数
- 实现业务逻辑处理、权限控制、订单调度等服务

### 三、地图服务配置
- 腾讯地图开发者后台管理
  - 路线规划 API
  - 驾车路线矩阵 API
  - 分配调用次数与并发控制
